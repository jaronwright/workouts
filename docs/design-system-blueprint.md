# Design System Migration Blueprint

> Generated by architecture analysis of the full codebase. This document guides all subsequent migration phases.

---

## 1. CollapsibleSection Unified API

Three separate implementations exist today:

| Location | Lines | Has Icon | Has Animation | Has Card Wrapper | Has Textarea | Has onToggle |
|---|---|---|---|---|---|---|
| `src/components/ui/CollapsibleSection.tsx` | 77 | Yes (`LucideIcon`) | Yes (Framer Motion spring) | Yes (`<Card>`) | No | Yes |
| `src/components/workout/CollapsibleSection.tsx` | 62 | No | No (CSS `max-h` transition) | No (bare `<div>`) | No | No |
| `src/components/review/ReflectionForm.tsx` (private) | ~55 | Yes (`ReactNode`) | Yes (Framer Motion via `springs.default`) | No (border div) | Yes (textarea with char count) | No |

### Differences

- **UI version**: Takes `icon: LucideIcon` (component ref), `iconColor: string` (Tailwind bg class), wraps in `<Card>`, uses `ChevronUp`/`ChevronDown` swap, has `onToggle` callback and `defaultExpanded`.
- **Workout version**: No icon at all, uses a colored accent bar (`w-1 h-4 rounded-full`), CSS-only animation (`max-h-[2000px]`), has `subtitle` as inline parenthetical, defaults to open.
- **Review version**: Takes `icon: ReactNode` (pre-rendered JSX), has built-in `textarea` with `maxLength` and character counter, uses `ChevronDown` with rotate animation, no card wrapper.

### Proposed Unified Interface

```typescript
interface CollapsibleSectionProps {
  /** Section title text */
  title: string
  /** Optional subtitle (displayed below or inline depending on variant) */
  subtitle?: string
  /** Leading icon — accepts a Phosphor Icon component or ReactNode */
  icon?: IconComponent | ReactNode
  /** Color applied to the icon container (Tailwind classes or CSS var) */
  iconColor?: string
  /** Content to render when expanded */
  children: ReactNode
  /** Whether section starts expanded (default: false) */
  defaultExpanded?: boolean
  /** Callback when toggle state changes */
  onToggle?: (expanded: boolean) => void
  /** Visual variant */
  variant?: 'card' | 'plain' | 'bordered'
  /** Show colored accent bar instead of icon (workout-style) */
  accentBar?: boolean
  /** Custom className for the outer container */
  className?: string
}
```

**Variant behavior:**
- `card` (default) — wraps in `<Card>` with `<CardContent>`, matches current UI CollapsibleSection
- `plain` — bare div with no border/bg, accent bar left indicator, matches current workout CollapsibleSection
- `bordered` — bordered div, no card shadow, matches current review CollapsibleSection

**Migration plan:**
1. Create unified component at `src/components/ui/CollapsibleSection.tsx` (replace existing)
2. Update `src/components/workout/CollapsibleSection.tsx` to re-export from ui with `variant="plain" accentBar defaultExpanded`
3. Update `src/components/review/ReflectionForm.tsx` to use ui CollapsibleSection with `variant="bordered"`, keep textarea as children
4. Update all 4 consumers in Profile.tsx (Security, Email, Feedback, Exercise Data) — they already use the `card` variant

**Consumer inventory:**
- `Profile.tsx` lines 691, 755, 792, 101 (ExerciseDataSection) — all use `ui/CollapsibleSection` via `<Card>` variant
- `Workout.tsx` — uses `workout/CollapsibleSection` (imported via `workout/index.ts`)
- `ReflectionForm.tsx` — private implementation, used only internally

---

## 2. Profile.tsx Split Plan

**Current size:** 1,038 lines — far too large for a single page component.

### Proposed Sub-Components

#### A. `ProfileHero.tsx` (~120 lines)
- **What:** Avatar, display name (with inline edit), email, trophy stats row
- **State:** `displayName`, `isEditingName`
- **Hooks:** `useProfile`, `useUpdateProfile`, `useAuthStore` (user email), `useToast`
- **Lines:** Profile.tsx 362-488

#### B. `WorkoutSplitSection.tsx` (~80 lines)
- **What:** Split selector grid with 6 plan options
- **State:** `showSplitConfirm`, `pendingSplitId`, `showOnboarding`
- **Hooks:** `useProfile`, `useUpdateProfile`, `useClearSchedule`
- **Includes:** Split change confirmation modal + OnboardingWizard trigger
- **Lines:** Profile.tsx 490-536, 939-979

#### C. `AppearanceSection.tsx` (~20 lines)
- **What:** Theme picker section with Monitor icon
- **State:** None (ThemePicker is self-contained)
- **Lines:** Profile.tsx 538-555

#### D. `PrivacySection.tsx` (~60 lines)
- **What:** Hide weight details toggle switch
- **State:** None (reads from profile, uses mutation directly)
- **Hooks:** `useProfile`, `useUpdateProfile`, `useToast`
- **Lines:** Profile.tsx 564-622

#### E. `WorkoutCycleSection.tsx` (~50 lines)
- **What:** Cycle day display, start date with date picker
- **State:** `dateInputRef`
- **Hooks:** `useCycleDay`, `useProfile`, `useUpdateProfile`
- **Lines:** Profile.tsx 624-676

#### F. `SecuritySection.tsx` (~60 lines)
- **What:** Change password, session management, delete account trigger
- **State:** `newPassword`, `confirmPassword`, `isChangingPassword`
- **Hooks:** `useAuthStore` (updatePassword, signOutAllDevices)
- **Lines:** Profile.tsx 688-749

#### G. `EmailSection.tsx` (~40 lines)
- **What:** Change email address form
- **State:** `newEmail`, `isChangingEmail`
- **Hooks:** `useAuthStore` (updateEmail)
- **Lines:** Profile.tsx 751-786

#### H. `FeedbackSection.tsx` (~120 lines)
- **What:** Bug/feature submission form + past submissions list
- **State:** `feedbackType`, `feedbackMessage`, `feedbackSubmitted`
- **Hooks:** `useSubmitFeedback`, `useUserFeedback`
- **Lines:** Profile.tsx 788-904

#### I. `DeleteAccountModal.tsx` (~50 lines)
- **What:** Confirmation modal with "DELETE" text input
- **State:** `deleteConfirmation`, `isDeleting`
- **Props:** `isOpen`, `onClose`
- **Lines:** Profile.tsx 982-1035

#### J. `useLifetimeStats.ts` (extract to hooks/)
- **What:** Custom hook already defined inside Profile.tsx (lines 36-94)
- Move to `src/hooks/useLifetimeStats.ts`

#### K. `ExerciseDataSection` (already extracted, lines 96-148)
- Move to `src/components/profile/ExerciseDataSection.tsx`

**Resulting Profile.tsx:** ~80 lines — imports + layout shell + StaggerList composition only.

**File placement:** All sub-components go in `src/components/profile/` alongside existing `AvatarUpload.tsx` and `NotificationSettings.tsx`.

---

## 3. Icon Migration Summary

### Files with lucide-react imports (60 source files)

| File | Icon Count | Icons Used | strokeWidth Usage |
|---|---|---|---|
| **Config files** | | | |
| `config/workoutConfig.ts` | 16 + `LucideIcon` type | Dumbbell, ArrowDown, Footprints, Bike, Zap, TrendingUp, Waves, Target, Workflow, Activity, Wind, ArrowUp, ArrowDownUp, Swords, Heart, Shield | No |
| `config/reviewConfig.ts` | 12 + `LucideIcon` type | Star, Zap, Trophy, Battery, Flame, Clock, Focus, CloudOff, Sparkles, Weight, Feather, Rocket | No |
| `config/communityConfig.ts` | 4 + `LucideIcon` type | Flame, Dumbbell, HandMetal, Star | No |
| **Pages** | | | |
| `pages/Profile.tsx` | 21 | Calendar, Shield, Mail, LogOut, Monitor, Dumbbell, Trophy, Flame, Star, ArrowLeftRight, ArrowUpDown, Heart, MessageSquarePlus, Bug, Lightbulb, Pencil, Check, X, Eye, EyeOff, Database | No |
| `pages/Home.tsx` | 7 | ChevronRight, Flame, Trophy, Calendar, Heart, Dumbbell, Activity | No |
| `pages/Schedule.tsx` | 3 | Moon, Plus, ChevronRight | Yes (1.5, 2) |
| `pages/Workout.tsx` | 1 | ArrowRight | No |
| `pages/WorkoutSelect.tsx` | 8 | Play, Heart, Activity, ChevronRight, Dumbbell, X, ArrowLeft, Clock | Yes (2.5) |
| `pages/Community.tsx` | 5 | Users, Bell, RefreshCw, Search, X | No |
| `pages/Auth.tsx` | 3 | Dumbbell, ArrowLeft, CheckCircle | No |
| `pages/AuthCallback.tsx` | 1 | Loader2 | No |
| `pages/RestDay.tsx` | 9 | Footprints, CircleDot, Move, HeartPulse, Waves, Droplets, Moon, Sparkles, Check | No |
| `pages/History.tsx` | 0 (imported in children) | — | Yes (4, via ProgressRing) |
| `pages/SessionDetail.tsx` | 12 | Clock, CheckCircle, Dumbbell, Trash2, Edit2, X, Save, MoreVertical, Share2, Layers, StickyNote, Camera | No |
| `pages/CardioSessionDetail.tsx` | 11 | Clock, MapPin, Timer, CheckCircle, Circle, Trash2, Share2, Zap, Activity, StickyNote, Camera | No |
| `pages/PublicSessionDetail.tsx` | 11 | Clock, CheckCircle, Dumbbell, Timer, Layers, StickyNote, MapPin, Zap, Activity, Star, ArrowRight | No |
| `pages/PublicProfile.tsx` | 4 | Flame, Calendar, Trophy, Dumbbell | No |
| `pages/CardioWorkout.tsx` | 4 | Play, Pause, ChevronDown, Timer | Yes (2.5) |
| `pages/MobilityDurationPicker.tsx` | 1 | Clock | No |
| `pages/MobilityWorkout.tsx` | 1 | Check | No |
| **UI Components** | | | |
| `components/ui/CollapsibleSection.tsx` | 3 + `LucideIcon` type | ChevronDown, ChevronUp, LucideIcon | No |
| `components/ui/Modal.tsx` | 1 | X | No |
| `components/ui/BottomSheet.tsx` | 1 | X | No |
| `components/ui/Toast.tsx` | 5 | X, CheckCircle, AlertCircle, AlertTriangle, Info | No |
| `components/ui/Avatar.tsx` | 1 | User | Yes (2.5, in SVG) |
| `components/ui/ThemePicker.tsx` | 3 | Sun, Moon, Monitor | No |
| `components/ui/StreakBar.tsx` | 2 + `LucideIcon` type | Check, Moon, LucideIcon | Yes (2, 2.5, 3) |
| **Layout Components** | | | |
| `components/layout/BottomNav.tsx` | 4 | Home, History, Calendar, Users | Yes (dynamic: 2.5/1.8) |
| `components/layout/Header.tsx` | 2 | ChevronLeft, LogOut | No |
| `components/layout/ErrorBoundary.tsx` | 2 | AlertTriangle, RefreshCw | No |
| `components/layout/OfflineBanner.tsx` | 2 | WifiOff, Wifi | No |
| **Workout Components** | | | |
| `components/workout/CollapsibleSection.tsx` | 1 | ChevronDown | No |
| `components/workout/ExerciseCard.tsx` | 5 | Info, Check, Circle, Sparkles, Cloud | Yes (2, 3) |
| `components/workout/RestTimer.tsx` | 4 | X, Play, Pause, RotateCcw | Yes (6, via SVG) |
| `components/workout/PRCelebration.tsx` | 2 | Trophy, Share2 | No |
| `components/workout/FormGuideSheet.tsx` | 7 | Loader2, Dumbbell, Zap, Info, BookOpen, CheckCircle2, AlertCircle | No |
| `components/workout/ScheduleWidget.tsx` | 7 + `LucideIcon` type | ChevronRight, ChevronLeft, Calendar, Check, Play, X, Dumbbell, LucideIcon | Yes (2, 2.5) |
| `components/workout/WorkoutDayCard.tsx` | 1 | ChevronRight | Yes (2.5) |
| `components/workout/CardioLogCard.tsx` | 1 | ChevronRight | Yes (2.5) |
| `components/workout/ProgressionBadge.tsx` | 1 | TrendingUp | No |
| **Review Components** | | | |
| `components/review/ReflectionForm.tsx` | 4 | ChevronDown, MessageSquare, ThumbsUp, Target | No |
| `components/review/PostWorkoutReview.tsx` | 5 | X, ChevronLeft, ChevronRight, Check, Sparkles | No |
| `components/review/StarRating.tsx` | 1 | Star | No |
| `components/review/ReviewSummaryCard.tsx` | 5 | Star, ChevronDown, Pencil, Trash2, ArrowRight | No |
| `components/review/WeeklyReviewCard.tsx` | 5 | Star, TrendingUp, TrendingDown, Minus, Hash | No |
| `components/review/EnergyLevel.tsx` | 3 | Battery, BatteryFull, Zap | No |
| `components/review/ReviewBadge.tsx` | 1 | Star | No |
| **Social Components** | | | |
| `components/social/ActivityFeed.tsx` | 4 | Dumbbell, Heart, Activity, User | No |
| `components/social/WorkoutCard.tsx` | 8 | Dumbbell, Heart, Activity, ChevronDown, Flame, ExternalLink, Weight, Clock | No |
| `components/social/CommentSection.tsx` | 3 | Send, Trash2, MessageCircle | No |
| `components/social/BadgeGrid.tsx` | 2 | X, Award | No |
| `components/social/ChallengeCard.tsx` | 4 | Target, Users, Trophy, Clock | No |
| `components/social/LeaderboardPanel.tsx` | 4 + `LucideIcon` type | Trophy, Flame, Dumbbell, Calendar | No |
| `components/social/WorkoutPhotos.tsx` | 4 | Camera, X, Loader2, Trash2 | No |
| `components/social/FollowButton.tsx` | 2 | UserPlus, Check | No |
| `components/social/NotificationPanel.tsx` | 2 | Bell, X | No |
| **Other Components** | | | |
| `components/onboarding/OnboardingWizard.tsx` | 11 | ChevronDown, ChevronLeft, ChevronRight, HelpCircle, RefreshCw, Calendar, Dumbbell, ArrowUp, User, Camera, Sparkles | Yes (3, via inline SVG) |
| `components/onboarding/OnboardingDayRow.tsx` | 4 | Moon, Check, Plus, X | No |
| `components/auth/PasswordStrengthIndicator.tsx` | 2 | Check, X | No |
| `components/auth/VerificationBanner.tsx` | 3 | Mail, X, RefreshCw | No |
| `components/calendar/SelectedDayPanel.tsx` | 3 | Calendar, Clock, ChevronRight | No |
| `components/calendar/CalendarGrid.tsx` | 2 | ChevronLeft, ChevronRight | No |
| `components/schedule/ScheduleDayEditor.tsx` | 4 | Moon, Plus, X, Trash2 | No |
| `components/profile/NotificationSettings.tsx` | 2 | Bell, BellOff | No |
| `components/profile/AvatarUpload.tsx` | 2 | Camera, Loader2 | No |
| `components/stats/StatsGrid.tsx` | ~16 | Multiple (imported on line 26) | No |
| `components/weather/WeatherCard.tsx` | 7 | MapPin, RefreshCw, ChevronDown, Wind, Droplets, Sun, CloudRain | No |
| `components/weather/UvIndexChart.tsx` | 1 | Sun | No |
| `components/motion/AnimatedProgress.tsx` | 0 | — | No |
| **Utilities** | | | |
| `utils/scheduleUtils.ts` | 1 + `LucideIcon` type | Moon, LucideIcon | No |

### LucideIcon Type References (6 files — all need migration)

1. `config/workoutConfig.ts` — `WorkoutStyle.icon: LucideIcon`
2. `config/reviewConfig.ts` — `TagOption.icon: LucideIcon`
3. `config/communityConfig.ts` — `ReactionConfig.icon: LucideIcon`
4. `utils/scheduleUtils.ts` — function return type
5. `components/ui/CollapsibleSection.tsx` — prop type
6. `components/ui/StreakBar.tsx` — `StreakDay.workoutIcon: LucideIcon`
7. `components/workout/ScheduleWidget.tsx` — internal type
8. `components/social/LeaderboardPanel.tsx` — internal type

### strokeWidth Usage (12 component files)

These need `strokeWidth` -> `weight` conversion:

| File | Usage | Phosphor Equivalent |
|---|---|---|
| `BottomNav.tsx` | `strokeWidth={isActive ? 2.5 : 1.8}` | `weight={isActive ? 'bold' : 'regular'}` |
| `StreakBar.tsx` | `strokeWidth={3}`, `strokeWidth={2.5}`, `strokeWidth={2}` | `weight='bold'`, `weight='bold'`, `weight='regular'` |
| `ExerciseCard.tsx` | `strokeWidth={3}`, `strokeWidth={2}` | `weight='bold'`, `weight='regular'` |
| `ScheduleWidget.tsx` | `strokeWidth={2}`, `strokeWidth={2.5}` | `weight='regular'`, `weight='bold'` |
| `WorkoutDayCard.tsx` | `strokeWidth={2.5}` | `weight='bold'` |
| `CardioLogCard.tsx` | `strokeWidth={2.5}` | `weight='bold'` |
| `Schedule.tsx` | `strokeWidth={1.5}`, `strokeWidth={2}` | `weight='light'`, `weight='regular'` |
| `WorkoutSelect.tsx` | `strokeWidth={2.5}` | `weight='bold'` |
| `CardioWorkout.tsx` | `strokeWidth={2.5}` | `weight='bold'` |
| `Avatar.tsx` | `strokeWidth={2.5}` (SVG, not Lucide prop) | Keep as-is (custom SVG) |
| `RestTimer.tsx` | `strokeWidth={6}` (SVG circle, not Lucide) | Keep as-is (SVG element) |
| `History.tsx` | `strokeWidth={4}` (ProgressRing SVG) | Keep as-is (SVG element) |
| `OnboardingWizard.tsx` | `strokeWidth={3}` (inline SVG checkmark) | Keep as-is (inline SVG) |

**Note:** `strokeWidth` on `<circle>`, `<line>`, `<path>` SVG elements is standard SVG and should NOT be changed. Only Lucide component `strokeWidth` props need migration.

---

## 4. Social Barrel Export Fixes

**Current `src/components/social/index.ts`:**
```typescript
export { ActivityFeed } from './ActivityFeed'
```

Only 1 of 12 components is exported via barrel. All other social components are imported directly by path:

**Components that need barrel exports:**

| Component | Imported By |
|---|---|
| `WorkoutCard` | Community.tsx, PublicProfile.tsx |
| `ReactionBar` | PublicSessionDetail.tsx, WorkoutCard.tsx (internal) |
| `CommentSection` | PublicSessionDetail.tsx |
| `NotificationPanel` | Community.tsx |
| `FeedTabs` | Community.tsx |
| `FollowButton` | Community.tsx, PublicProfile.tsx |
| `ChallengeCard` | Community.tsx |
| `LeaderboardPanel` | Community.tsx |
| `BadgeCelebration` | Community.tsx |
| `BadgeGrid` | PublicProfile.tsx |
| `WorkoutPhotos` | SessionDetail.tsx, CardioSessionDetail.tsx |

**Proposed `src/components/social/index.ts`:**
```typescript
export { ActivityFeed } from './ActivityFeed'
export { BadgeCelebration } from './BadgeCelebration'
export { BadgeGrid } from './BadgeGrid'
export { ChallengeCard } from './ChallengeCard'
export { CommentSection } from './CommentSection'
export { FeedTabs } from './FeedTabs'
export { FollowButton } from './FollowButton'
export { LeaderboardPanel } from './LeaderboardPanel'
export { NotificationPanel } from './NotificationPanel'
export { ReactionBar } from './ReactionBar'
export { WorkoutCard } from './WorkoutCard'
export { WorkoutPhotos } from './WorkoutPhotos'
```

Then update all consumers to import from `@/components/social` instead of direct paths.

---

## 5. Orphaned Files List

### Markdown files in `src/` (should move to `docs/reference/`)

| File | Content | Action |
|---|---|---|
| `src/EXERCISEDB_API.md` | ExerciseDB API documentation | Move to `docs/reference/` |
| `src/API_NINJAS_EXERCISES.md` | API Ninjas exercise API notes | Move to `docs/reference/` |
| `src/STRAVA_API.md` | Strava API integration notes | Move to `docs/reference/` |
| `src/WGER_API.md` | wger API documentation | Move to `docs/reference/` |
| `src/APPLE_HEALTHKIT.md` | Apple HealthKit integration notes | Move to `docs/reference/` |
| `src/WHOOP_API.md` | Whoop API documentation | Move to `docs/reference/` |

### Root-level files (likely stale/temporary)

| File | Action |
|---|---|
| `DEBUG-RALPH-LOOP.md` | Delete (debug artifact) |
| `ELECTRIC-MINT-PRO-IMPLEMENTATION-PROMPT.md` | Move to `docs/reference/` or delete |
| `ELECTRIC-MINT-PRO-RALPH-LOOP.md` | Move to `docs/reference/` or delete |
| `Electric-Mint-Pro-Color-System.docx` | Move to `docs/reference/` or delete |
| `color-system-reference.jsx` | Delete (superseded by designTokens.ts) |
| `color-system-v5-proposal.jsx` | Delete (old proposal) |
| `color-system-v6-proposal.jsx` | Delete (old proposal) |
| `color-system-v7-final.jsx` | Delete (old proposal) |
| `color-system-v7-proposal.jsx` | Delete (old proposal) |

---

## 6. Repeated Pattern Catalog

### A. Icon Badge Circle (10+ occurrences)

```
w-10 h-10 rounded-full flex items-center justify-center
```

Found in: `Home.tsx`, `RestDay.tsx`, `SelectedDayPanel.tsx`, `OnboardingWizard.tsx`, `ScheduleDayEditor.tsx` (x2), `ui/CollapsibleSection.tsx`, `ActivityFeed.tsx`, `ExerciseCard.tsx`, `NotificationSettings.tsx`

**Recommendation:** Extract `IconBadge` component:
```typescript
interface IconBadgeProps {
  icon: IconComponent
  color?: string       // icon color
  bgColor?: string     // circle background
  size?: 'sm' | 'md' | 'lg'
  className?: string
}
```

### B. Section Header with Accent Bar (4 occurrences)

```
<div className="w-1 h-4 rounded-full" style={{ backgroundColor: 'var(--color-primary)' }} />
<h3 className="text-[var(--text-xs)] ... uppercase tracking-[var(--tracking-widest)]">
```

Found in: `Profile.tsx` (Workout Split header), `Workout.tsx` (x2), `workout/CollapsibleSection.tsx`

**Recommendation:** Extract `SectionHeader` component:
```typescript
interface SectionHeaderProps {
  title: string
  subtitle?: string
  accentColor?: string
  trailing?: ReactNode   // e.g., badge or label on right
}
```

### C. Uppercase Muted Section Label (3 occurrences in Profile.tsx alone)

```
text-[var(--text-xs)] text-[var(--color-text-muted)] uppercase tracking-[var(--tracking-widest)]
```

Found in: `Profile.tsx` lines 542, 569, 629 (Appearance, Privacy, Workout Cycle)

**Recommendation:** Absorb into `SectionHeader` component above.

### D. Gradient Divider (2 occurrences)

```
<div className="h-px" style={{ background: 'linear-gradient(to right, transparent, var(--color-border-strong), transparent)' }} />
```

Found in: `Profile.tsx` lines 682, 910

**Recommendation:** Extract `Divider` component (or CSS utility class `.divider-gradient`).

### E. Toggle Switch (1 occurrence, but should be a shared primitive)

Custom toggle switch implementation in `Profile.tsx` lines 599-617 (Privacy section).

**Recommendation:** Extract `Toggle` or `Switch` component to `src/components/ui/Toggle.tsx`:
```typescript
interface ToggleProps {
  checked: boolean
  onChange: (checked: boolean) => void
  disabled?: boolean
  label?: string
  description?: string
}
```

### F. Stat Card / Metric Display (6+ occurrences)

Pattern: `font-mono-stats` + large number + small uppercase label below

Found in: `Profile.tsx` (x3 trophy stats), `Home.tsx` (x3 week stats), `StatsGrid.tsx` (x12+)

**Recommendation:** Extract `MetricCard` component:
```typescript
interface MetricCardProps {
  value: number | string
  label: string
  highlight?: boolean  // glow effect
  className?: string
}
```

### G. Empty State Pattern (seen across multiple pages)

Text-centered layout with icon/emoji + title + description + optional CTA. Used in Community feed, History, RestDay.

**Recommendation:** Extract `EmptyState` component.

---

## 7. Risk Assessment

### High Risk

| Risk | Impact | Mitigation |
|---|---|---|
| **Icon name mismatches** | Broken rendering (blank icons) | Create a comprehensive Lucide-to-Phosphor name mapping before migration. Run `npx vite build` after each batch. |
| **LucideIcon type in config files** | Type errors across 8+ files | Migrate config type definitions FIRST, before component migration. |
| **BottomNav dynamic strokeWidth** | Active/inactive state looks wrong | Test `weight={isActive ? 'bold' : 'regular'}` explicitly. BottomNav is visible on every screen. |
| **Profile.tsx split** | Broken state sharing, lost scroll-to-feedback behavior | Split one section at a time. Keep `feedbackRef` scroll logic in parent. Test each section individually. |

### Medium Risk

| Risk | Impact | Mitigation |
|---|---|---|
| **SVG strokeWidth vs Lucide strokeWidth** | Accidentally converting SVG attributes | Only convert `strokeWidth` on Lucide component JSX, NOT on `<circle>`, `<line>`, `<path>`, `<svg>` elements. Grep for `<Icon.*strokeWidth` pattern. |
| **Tree-shaking regression** | Bundle size increase | Phosphor supports tree-shaking via named imports. Verify with `npx vite build` + check output size. |
| **Social barrel export** | Import resolution changes | Update all imports in a single atomic commit. Run build immediately after. |
| **Workout CollapsibleSection re-export** | CSS transition replaced by Framer Motion | Keep `variant="plain"` using CSS-only animation to preserve current behavior. |

### Low Risk

| Risk | Impact | Mitigation |
|---|---|---|
| **Orphaned file cleanup** | None (no code references) | Safe to move/delete; they're documentation only. |
| **Gradient divider extraction** | Visual regression if spacing changes | Use exact same styles, just wrapped in component. |
| **Test file icon imports** | Test compilation errors | Update test files that import Lucide icons (3 test files found: `SelectedDayPanel.test.tsx`, `CalendarDayCell.test.tsx`, `scheduleUtils.test.ts`). |

### Execution Order (recommended)

1. **Config types first** — Migrate `LucideIcon` type to Phosphor `Icon` type in config files + utility files
2. **Leaf components** — Migrate components with no dependents (ReviewBadge, ProgressionBadge, etc.)
3. **Shared UI primitives** — Migrate Toast, Modal, BottomSheet, Avatar, Badge
4. **Heavy pages last** — Profile.tsx, Home.tsx, SessionDetail.tsx (most imports)
5. **Build verification** after each batch of 5-10 files

---

## Appendix: Unique Icon Names Used (sorted)

Total unique Lucide icons across codebase: **~85**

```
Activity, AlertCircle, AlertTriangle, ArrowDown, ArrowDownUp, ArrowLeft,
ArrowLeftRight, ArrowRight, ArrowUp, ArrowUpDown, Award, Battery,
BatteryFull, Bell, BellOff, Bike, BookOpen, Bug, Calendar, Camera,
Check, CheckCircle, CheckCircle2, ChevronDown, ChevronLeft, ChevronRight,
ChevronUp, Circle, CircleDot, Clock, Cloud, CloudOff, CloudRain,
Database, Dumbbell, Droplets, Edit2, ExternalLink, Eye, EyeOff, Feather,
Flame, Focus, Footprints, HandMetal, Hash, Heart, HeartPulse, HelpCircle,
History, Home, Info, Layers, Lightbulb, Loader2, LogOut, Mail, MapPin,
MessageCircle, MessageSquare, MessageSquarePlus, Minus, Monitor, Moon,
MoreVertical, Move, Pause, Pencil, Play, Plus, RefreshCw, Rocket,
RotateCcw, Save, Search, Send, Share2, Shield, Sparkles, Star, StickyNote,
Sun, Swords, Target, Timer, Trash2, TrendingDown, TrendingUp, Trophy,
User, UserPlus, Users, Waves, Weight, WifiOff, Wifi, Wind, Workflow,
X, Zap
```
